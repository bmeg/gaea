#!/usr/bin/env python

import argparse
import subprocess

def migrate(args):
    subprocess.call('sbt --error "command/run migrate ' + args.configuration + '"', shell=True)

def ingest(args):
    print('ingest ' + str(args))

def start(args):
    print('start ' + str(args))

def parse_args():
    parser = argparse.ArgumentParser()
    sub = parser.add_subparsers()

    migrate_parser = sub.add_parser('init')
    migrate_parser.add_argument('configuration', nargs='?', default='resources/config/gaia.yaml')
    migrate_parser.set_defaults(func=migrate)

    ingest_parser = sub.add_parser('ingest')
    ingest_parser.add_argument('configuration')
    ingest_parser.set_defaults(func=ingest)

    start_parser = sub.add_parser('start')
    start_parser.add_argument('configuration')
    start_parser.set_defaults(func=start)

    return parser.parse_args()

if __name__ == '__main__':
    args = parse_args()
    args.func(args)
